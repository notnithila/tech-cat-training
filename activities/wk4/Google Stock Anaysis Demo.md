# In Class Demo 

```sql
use role de;
use warehouse Compute_wh;
use schema techcatalyst_de.public;

SELECT 
    DATE, 
    CLOSE,
    LAG(CLOSE, 2) OVER (ORDER BY DATE) AS PREV_CLOSE,
    ((CLOSE - LAG(CLOSE) OVER (ORDER BY DATE)) / LAG(CLOSE) OVER (ORDER BY DATE)) * 100 AS PCT_CHANGE
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;


SELECT 
    DATE, 
    CLOSE,
    AVG(CLOSE) OVER (ORDER BY DATE ROWS BETWEEN 129 PRECEDING AND CURRENT ROW) AS MOVING_AVG_7D
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;


SELECT 
    DATE, 
    VOLUME,
    ROW_NUMBER() OVER (ORDER BY VOLUME DESC) as row_num 
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
QUALIFY 
    row_num = 1;
    -- ROW_NUMBER() OVER (ORDER BY VOLUME DESC) = 1;


SELECT 
    DATE, 
    CLOSE,
    LAG(CLOSE) OVER (ORDER BY DATE) AS PREV_CLOSE,
    CLOSE - LAG(CLOSE) OVER (ORDER BY DATE) AS DAILY_CHANGE
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;


SELECT 
    DATE, 
    CLOSE,
    AVG(CLOSE) OVER (ORDER BY DATE ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS MOVING_AVG_30D
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;

SELECT 
    DATE, 
    CLOSE,
    LAG(CLOSE) OVER (ORDER BY DATE) AS PREV_CLOSE,
    ((CLOSE - LAG(CLOSE) OVER (ORDER BY DATE)) / LAG(CLOSE) OVER (ORDER BY DATE)) * 100 AS PCT_CHANGE
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;

SELECT 
    DATE, 
    CLOSE,
    MAX(CLOSE) OVER (ORDER BY DATE ROWS BETWEEN 59 PRECEDING AND CURRENT ROW) AS MAX_CLOSE_60D,
    MIN(CLOSE) OVER (ORDER BY DATE ROWS BETWEEN 59 PRECEDING AND CURRENT ROW) AS MIN_CLOSE_60D
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;

SELECT 
    DATE, 
    CLOSE,
    VOLUME,
    SUM(CLOSE * VOLUME) OVER (ORDER BY DATE) / SUM(VOLUME) OVER (ORDER BY DATE) AS VWAP
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;




SELECT 
    DATE, 
    CLOSE,
    LAG(CLOSE) OVER (ORDER BY DATE) AS PREV_CLOSE,
    CLOSE - LAG(CLOSE) OVER (ORDER BY DATE) AS DAILY_CHANGE
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;


SELECT 
    DATE, 
    CLOSE,
    AVG(CLOSE) OVER (ORDER BY DATE ROWS BETWEEN 29 PRECEDING AND CURRENT ROW) AS MOVING_AVG_30D
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;


SELECT 
    DATE, 
    CLOSE,
    LAG(CLOSE) OVER (ORDER BY DATE) AS PREV_CLOSE,
    ((CLOSE - LAG(CLOSE) OVER (ORDER BY DATE)) / LAG(CLOSE) OVER (ORDER BY DATE)) * 100 AS PCT_CHANGE
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;

SELECT 
    DATE, 
    CLOSE,
    MAX(CLOSE) OVER (ORDER BY DATE ROWS BETWEEN 59 PRECEDING AND CURRENT ROW) AS MAX_CLOSE_60D,
    MIN(CLOSE) OVER (ORDER BY DATE ROWS BETWEEN 59 PRECEDING AND CURRENT ROW) AS MIN_CLOSE_60D
FROM 
    TECHCATALYST_DE.PUBLIC.GOOGLE_STOCKS
ORDER BY 
    DATE;




```

